{"remainingRequest":"/Users/hyunjongkim/Downloads/parula자료들/parula-frontend/client-v1.0/node_modules/babel-loader/lib/index.js!/Users/hyunjongkim/Downloads/parula자료들/parula-frontend/client-v1.0/src/services/session.service.js","dependencies":[{"path":"/Users/hyunjongkim/Downloads/parula자료들/parula-frontend/client-v1.0/src/services/session.service.js","mtime":1633568186000},{"path":"/Users/hyunjongkim/Downloads/parula자료들/parula-frontend/client-v1.0/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hyunjongkim/Downloads/parula자료들/parula-frontend/client-v1.0/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKCi8qKiog66Gc6re47J24IO2UhOuhnOyEuOyKpCDsoJXrpqwNCjEuIOyEuOyFmCDsobTsnqzsl6zrtoAg7ZmV7J24DQoyLiDsp4DqsJLso7zshowg6rCA7KC47Jik6riwDQozLiDsp4DqsJHso7zshozqsIAg65Ox66Gd65CY7Ja0IOyeiOuKlOyngCDtmZXsnbgNCjQuIOu2hOq4sOyymOumrA0KICAgIC0g7ZqM7JuQ6rCA7J6FDQogICAgLSDroZzqt7jsnbgNCiAgICAtIOuhnOq3uOyduOyZhOujjA0KDQrtmozsm5DqsIDsnoUg67CPIOuhnOq3uOyduCDsnbTtm4QsIOuhnOq3uOyduOygleuztOulvCDroZzsu6zsiqTthqDrpqzsp4Dsl5Ag7KCA7J6lDQotIOy1nOyiheuhnOq3uOyduOyLnOqwhA0KLSDso7zshowNCi0g64uJ64Sk7J6EDQotIOyVhOuwlO2DgA0KICovCmV4cG9ydCBkZWZhdWx0IHsKICBjaGVja1Nlc3Npb246IGZ1bmN0aW9uIGNoZWNrU2Vzc2lvbigpIHsKICAgIHJldHVybiB0cnVlOwogIH0sCiAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkgewogICAgY29uc29sZS5sb2coJ2NsZWFyIHNlc3Npb24nKTsgLy8gdGhpcy5sb2NhbFN0b3JhZ2UuY2xlYXIoKTsKCiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnX19zZXNzaW9uX18nLCBudWxsKTsKICB9LAogIHNldFVzZXJJZDogZnVuY3Rpb24gc2V0VXNlcklkKHVzZXJfaWQpIHsKICAgIHZhciBzZXNzaW9uID0gdGhpcy5sb2FkU2Vzc2lvbigpOwogICAgc2Vzc2lvbi51c2VySWQgPSB1c2VyX2lkOwogICAgdGhpcy5zYXZlU2Vzc2lvbihzZXNzaW9uKTsKICB9LAogIGdldFVzZXJJZDogZnVuY3Rpb24gZ2V0VXNlcklkKCkgewogICAgdmFyIHNlc3Npb24gPSB0aGlzLmxvYWRTZXNzaW9uKCk7CiAgICByZXR1cm4gc2Vzc2lvbi51c2VySWQ7CiAgfSwKICBzZXROaWNrbmFtZTogZnVuY3Rpb24gc2V0Tmlja25hbWUobmlja25hbWUpIHsKICAgIHZhciBzZXNzaW9uID0gdGhpcy5sb2FkU2Vzc2lvbigpOwogICAgc2Vzc2lvbi5uaWNrbmFtZSA9IG5pY2tuYW1lOwogICAgdGhpcy5zYXZlU2Vzc2lvbihzZXNzaW9uKTsKICB9LAogIGdldE5pY2tuYW1lOiBmdW5jdGlvbiBnZXROaWNrbmFtZSgpIHsKICAgIHZhciBzZXNzaW9uID0gdGhpcy5sb2FkU2Vzc2lvbigpOwogICAgcmV0dXJuIHNlc3Npb24ubmlja25hbWU7CiAgfSwKICBsb2FkU2Vzc2lvbjogZnVuY3Rpb24gbG9hZFNlc3Npb24oKSB7CiAgICB0cnkgewogICAgICB2YXIgc2Vzc2lvbiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ19fc2Vzc2lvbl9fJykpOwogICAgICByZXR1cm4gc2Vzc2lvbiA/IHNlc3Npb24gOiB7fTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcmV0dXJuIHt9OwogICAgfQogIH0sCiAgc2F2ZVNlc3Npb246IGZ1bmN0aW9uIHNhdmVTZXNzaW9uKHNlc3Npb24pIHsKICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdfX3Nlc3Npb25fXycsIEpTT04uc3RyaW5naWZ5KHNlc3Npb24pKTsKICB9LAogIHNldEl0ZW1zOiBmdW5jdGlvbiBzZXRJdGVtcygpIHsKICAgIHZhciBpdGVtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogewogICAgICBwbGF0Zm9ybTogcGxhdGZvcm0sCiAgICAgIHdhbGxldDogd2FsbGV0LAogICAgICBuaWNrbmFtZTogbmlja25hbWUsCiAgICAgIGF2YXRhcjogYXZhdGFyLAogICAgICB1c2VySWQ6IHVzZXJJZCwKICAgICAgbXNnOiBtc2csCiAgICAgIHNpZzogc2lnCiAgICB9OwogICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7CiAgICB2YXIgc2Vzc2lvbiA9IHRoaXMubG9hZFNlc3Npb24oKTsKICAgIHNlc3Npb24ubGFzdFRpbWUgPSBub3c7CiAgICBPYmplY3Qua2V5cyhpdGVtcykuZm9yRWFjaChmdW5jdGlvbiAoaykgewogICAgICBpZiAoaXRlbXNba10pIHNlc3Npb25ba10gPSBpdGVtc1trXTsKICAgIH0pOwogICAgdmFyIHN0cmluZ2VkX3Nlc3Npb24gPSBKU09OLnN0cmluZ2lmeShzZXNzaW9uKTsKICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdfX3Nlc3Npb25fXycsIHN0cmluZ2VkX3Nlc3Npb24pOwogIH0sCiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoKSB7CiAgICB0aGlzLmNsZWFyKCk7CiAgfSwKICB2YWxpZDogZnVuY3Rpb24gdmFsaWQoX2FkZHIpIHsKICAgIGlmIChfYWRkciA9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHZhciBzZXNzaW9uID0gdGhpcy5sb2FkU2Vzc2lvbigpOwogICAgdmFyIGxhc3QgPSBzZXNzaW9uLmxhc3RUaW1lOwogICAgY29uc29sZS5sb2coIiIuY29uY2F0KF9hZGRyLCAiLCAiKS5jb25jYXQoc2Vzc2lvbi5hZGRyZXNzLCAiIHNlc3NlaW9uICEhIikpOwoKICAgIGlmIChzZXNzaW9uLmFkZHJlc3MgJiYgX2FkZHIudG9VcHBlckNhc2UoKSAhPT0gc2Vzc2lvbi5hZGRyZXNzLnRvVXBwZXJDYXNlKCkpIHsKICAgICAgY29uc29sZS5sb2coIiIuY29uY2F0KF9hZGRyLCAiLCAiKS5jb25jYXQoc2Vzc2lvbi5hZGRyZXNzLCAiIFx1QzEzOFx1QzE1OFx1QzgxNVx1QkNGNFx1QUMwMCBcdUM3N0NcdUNFNThcdUQ1NThcdUM5QzAgXHVDNTRBXHVDMkI1XHVCMkM4XHVCMkU0LiIpKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh0aGlzLmlzRXhwaXJlZChsYXN0KSkgewogICAgICBjb25zb2xlLmxvZygi7Jyg7Zqo6riw6rCE7J20IOunjOujjOuQnCDthqDtgbDsnoXri4jri6QuIik7IC8vIOy2lOqwgOuhnCDtlbTspIQg7J6R7JeFIOyXhuuKlOyngCDtmZXsnbgKCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9LAogIGlzRXhwaXJlZDogZnVuY3Rpb24gaXNFeHBpcmVkKGN1ckRhdGUpIHsKICAgIHZhciB0b2RheSwgcmVzdWx0RGF0ZTsKICAgIHRvZGF5ID0gbmV3IERhdGUoKTsKICAgIHJlc3VsdERhdGUgPSBuZXcgRGF0ZShjdXJEYXRlKTsKICAgIHZhciB0aW1lZ2FwID0gKHRvZGF5IC0gcmVzdWx0RGF0ZSkgLyAoNjAgKiA2MCAqIDEwMDApOyAvLyBUaW1lIChtaW51dGVzICogc2Vjb25kcyAqIG1pbGxpc2Vjb25kKQoKICAgIGlmICh0aW1lZ2FwIDw9IDI0KSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCcyNOyLnOqwhCDsnbTrgrTsnoXri4jri6QuKCcrdGltZWdhcCsnKScpCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCcyNOyLnOqwhOydtCDsp4DrgqzsirXri4jri6QuKCcrdGltZWdhcCsnKScpCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/hyunjongkim/Downloads/parula자료들/parula-frontend/client-v1.0/src/services/session.service.js"],"names":["checkSession","clear","console","log","localStorage","setItem","setUserId","user_id","session","loadSession","userId","saveSession","getUserId","setNickname","nickname","getNickname","JSON","parse","getItem","e","stringify","setItems","items","platform","wallet","avatar","msg","sig","now","Date","lastTime","Object","keys","forEach","k","stringed_session","logout","valid","_addr","undefined","last","address","toUpperCase","isExpired","curDate","today","resultDate","timegap"],"mappings":"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","sourcesContent":["/*** 로그인 프로세스 정리\r\n1. 세션 존재여부 확인\r\n2. 지값주소 가져오기\r\n3. 지갑주소가 등록되어 있는지 확인\r\n4. 분기처리\r\n    - 회원가입\r\n    - 로그인\r\n    - 로그인완료\r\n\r\n회원가입 및 로그인 이후, 로그인정보를 로컬스토리지에 저장\r\n- 최종로그인시간\r\n- 주소\r\n- 닉네임\r\n- 아바타\r\n */\r\n\r\nexport default {\r\n    checkSession() {\r\n        return true;\r\n    },\r\n    clear(){\r\n        console.log('clear session');\r\n        // this.localStorage.clear();\r\n        localStorage.setItem('__session__', null);\r\n    },\r\n    setUserId(user_id){\r\n        var session = this.loadSession();\r\n        session.userId = user_id;\r\n        this.saveSession(session);\r\n    },\r\n    getUserId(){\r\n        var session = this.loadSession();\r\n        return session.userId;\r\n    },\r\n    setNickname(nickname){\r\n        var session = this.loadSession();\r\n        session.nickname = nickname;\r\n        this.saveSession(session);\r\n    },\r\n    getNickname(){\r\n        var session = this.loadSession();\r\n        return session.nickname;\r\n    },\r\n    loadSession(){\r\n        try{\r\n            var session = JSON.parse(localStorage.getItem('__session__'))\r\n            return session?session:{};\r\n        }catch(e){\r\n            return {}\r\n        }\r\n    },\r\n    saveSession(session){\r\n        localStorage.setItem('__session__', JSON.stringify(session));\r\n    },\r\n\r\n    setItems(items = {platform, wallet, nickname, avatar, userId, msg, sig}) {\r\n        const now = new Date();\r\n        let session = this.loadSession();\r\n        session.lastTime = now;\r\n\r\n        Object.keys(items).forEach(k => {\r\n            if(items[k])\r\n                session[k] = items[k]\r\n        });\r\n\r\n        const stringed_session = JSON.stringify(session)\r\n        localStorage.setItem('__session__', stringed_session);\r\n    },\r\n\r\n    logout(){\r\n        this.clear();\r\n    },\r\n\r\n    valid(_addr) {\r\n        if(_addr == undefined){\r\n            return false;\r\n        }\r\n        const session = this.loadSession()\r\n        const last = session.lastTime;\r\n        console.log(`${_addr}, ${session.address} sesseion !!`)\r\n        if(session.address && _addr.toUpperCase() !== session.address.toUpperCase()){\r\n            console.log(`${_addr}, ${session.address} 세션정보가 일치하지 않습니다.`)\r\n            return false;\r\n        }\r\n        if(this.isExpired(last)){\r\n            console.log(\"유효기간이 만료된 토큰입니다.\") // 추가로 해줄 작업 없는지 확인\r\n            return false;\r\n        }\r\n        return true\r\n    },\r\n\r\n    isExpired(curDate) {\r\n        var today, resultDate;\r\n        today = new Date();\r\n        resultDate = new Date(curDate);\r\n        let timegap = (today - resultDate) / (60 * 60 * 1000);\r\n\r\n        // Time (minutes * seconds * millisecond)\r\n        if (timegap <= 24) {\r\n            // console.log('24시간 이내입니다.('+timegap+')')\r\n            return false;\r\n        } else {\r\n            // console.log('24시간이 지났습니다.('+timegap+')')\r\n            return true;\r\n        }\r\n    }\r\n\r\n}"]}]}